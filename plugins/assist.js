/*Merasa keren üòé
jangan ganti wm ye
buat susah bang
thx to arif
*/
let handler  = async (m, { itsu, usedPrefix: _p }) => {
  m.reply(' ```Loading...``` ')
  let fs = require('fs')
  let eror = 'https://telegra.ph/file/50beb3a1485c5853816a5.jpg'
  let who = m.mentionedJid && m.mentionedJid[0] ? m.mentionedJid[0] : m.fromMe ? eror : m.sender
  let pp = 'https://telegra.ph/file/2114ab18f6b1a7181b683.jpg'
  try {
    pp = await itsu.getProfilePicture(who)
  } catch (e) {

  }
  let ppBot = await itsu.getProfilePicture(itsu.user.jid)
  let yts = require('yt-search')
let fetch = require('node-fetch')
let tag = `@${m.sender.split('@')[0]} üê¶`
 m, { contextInfo: { mentionedJid: itsu.parseMention(tag) }}
 let ow = `@${'6283820073017'.split('@')[0]}`
 m, { contextInfo: { mentionedJid: itsu.parseMention(tag) }}
 let pat1 = `@${'62813828362494'.split('@')[0]}`
 m, { contextInfo: { mentionedJid: itsu.parseMention(tag) }}
 let pat2 = `@${'6283801499848'.split('@')[0]}`
 m, { contextInfo: { mentionedJid: itsu.parseMention(tag) }}
 let pat3 = `@${'31687221333'.split('@')[0]}`
 m, { contextInfo: { mentionedJid: itsu.parseMention(tag) }}
let uwu = global.thumb
let jam = new Date
let clock = jam.toLocaleTimeString('us')
  let path = require('path')
  let levelling = require('../lib/levelling')
let thumbnail = global.thumb2
let buffer = await itsu.prepareMessage('0@s.whatsapp.net', thumbnail, 'imageMessage')
let { performance } = require('perf_hooks')
function kyun(seconds){
  function pad(s){
    return (s < 10 ? '0' : '') + s;
  }
  var hours = Math.floor(seconds / (60*60));
  var minutes = Math.floor(seconds % (60*60) / 60);
  var seconds = Math.floor(seconds % 60);

  //return pad(hours) + ':' + pad(minutes) + ':' + pad(seconds)
  return `${pad(hours)}H ${pad(minutes)}M ${pad(seconds)}S`
}
runtime = process.uptime()
					Rtime = `${kyun(runtime)}`

 const teksnye =[
'https://youtu.be/IiYRFELAC0s',
'https://youtu.be/bNoFWGc1iJ0',
'https://youtu.be/DKm8Fg7dAp0',
'https://youtu.be/PagvjtVfsPk',
'https://youtu.be/CQLgEvxPs2w',
'https://youtu.be/MsLnLxxjzPE',
'https://youtu.be/YkDCqgk-QZY',
'https://youtu.be/RGihGa5eAA8',
'https://youtu.be/YkDCqgk-QZY',
'https://youtu.be/KCOdjVN-x64',
'https://youtu.be/6t_fdHhFrTg',
'https://youtu.be/xzu_ODGpCRs',
'https://youtu.be/Rz1diG58Rhs',
'https://youtu.be/umQDV0UHUsQ',
'https://youtu.be/W3m3yKpMTDg',
'https://youtu.be/jRDJv5lfiH0',
'https://youtu.be/FjdUiHW5JpQ',
'https://youtu.be/i3OgJLwB2lc',
'https://youtu.be/r1_EDhYbsHA',
'https://youtu.be/MsLnLxxjzPE',
'https://youtu.be/JWHV8lPTzPs',
'https://youtu.be/EjVcqMknvUU',
'https://youtu.be/2iCEd94TZ4o',
'https://youtu.be/S8F2L3v10mA',
'https://youtu.be/xvRWA9_18So',
'https://youtu.be/sSynIGIVjUs',
'https://youtu.be/E6NQYmO2qbA',
'https://youtu.be/usY2mQGtpyw',
'https://youtu.be/dMPnLAXAOBY',
'https://youtu.be/b0md2fEIFpg',
'https://youtu.be/e08eDavj0oI',
'https://youtu.be/IYo8iXPCmgQ',
'https://youtu.be/iuHy1fHikVo',
'https://youtu.be/TwbhA23jSsw',
]
var tod = teksnye[Math.floor(Math.random() * (teksnye.length))]
 let vid = await yts(tod)
let waktu = new Date().getHours()

let ucapWaktu = waktu > 2 && waktu < 4 ? 'Dini Hari' : waktu < 11 ? 'Good MorningüåÑ' : waktu < 16 ? 'Good Afternoon‚òÄÔ∏è' : waktu < 19 ? 'Good Afternoonüåá' : 'Good Nightüåô'
  const more = String.fromCharCode(8206)
const readMore = more.repeat(4001)

function clockString(ms) {
  let h = isNaN(ms) ? '--' : Math.floor(ms / 3600000)
  let m = isNaN(ms) ? '--' : Math.floor(ms / 60000) % 60
  let s = isNaN(ms) ? '--' : Math.floor(ms / 1000) % 60
  return [h, m, s].map(v => v.toString().padStart(2, 0) ).join(':')
}
let ling = global.thumb3
const {
    MessageType,
    Mimetype
} = require("@adiwajshing/baileys");
const anu = {
	key : {
                          participant : '0@s.whatsapp.net'
                        },
       message: {
                    orderMessage: {
                            itemCount : 999999999999,
                            itemCoun : 404,
                            surface : 404,
                            message: `¬© ${itsu.user.name}\nSimple WhatsApp Bot`,
                            orderTitle: 'B',
                            thumbnail: await (await fetch(ppBot)).buffer(), 
                            sellerJid: '0@s.whatsapp.net'
          
                          }
                        }
                      }
   const emo =['üéã', 'üé´', 'üõ†Ô∏è', '‚öôÔ∏è', 'üìä', 'üîñ', '‚úÖ', 'üåÄ', 'üí¨']
                      
   var moe = emo[Math.floor(Math.random() * (emo.length))]
   

                      let package = JSON.parse(fs.readFileSync(path.join(__dirname, '../package.json')))
    let { exp, limit, level } = global.DATABASE.data.users[m.sender]
    let { min, xp, max } = levelling.xpRange(level, global.multiplier)
    let name = itsu.getName(m.sender)
    let d = new Date(new Date - (4 * 3600000))
    let locale = 'id'
    let weton = ['Pahing', 'Pon', 'Wage', 'Kliwon', 'Legi'][Math.floor(((d * 1) + d.getTimezoneOffset()) / 84600000) % 5]
    let week = d.toLocaleDateString(locale, { weekday: 'long' })
    let date = d.toLocaleDateString(locale, {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    })
    let dateIslamic = Intl.DateTimeFormat(locale + '-TN-u-ca-islamic', {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    }).format(d)
    let time = d.toLocaleTimeString(locale, {
      hour: 'numeric',
      minute: 'numeric',
      second: 'numeric'
    })
    let _uptime = process.uptime() * 1000
    let _muptime
    if (process.send) {
      process.send('uptime')
      _muptime = await new Promise(resolve => {
        process.once('message', resolve)
        setTimeout(resolve, 1000)
      }) * 1000
    }
    let muptime = clockString(_muptime)
    let uptime = clockString(_uptime)
    let totalreg = Object.keys(global.DATABASE._data.users).length
    let rtotalreg = Object.values(global.DATABASE._data.users).filter(user => user.registered == true).length
    let tags = {
      'main': 'üÑºüÑ∞üÑ∏üÑΩ',
       'rpg': 'üÖÅüÑøüÑ∂',
      'game': 'üÑ∂üÑ∞üÑºüÑ¥',
      'xp': 'üÑ¥üÖáüÑø & üÑªüÑ∏üÑºüÑ∏üÖÉ',
      'sticker': 'üÖÇüÖÉüÑ∏üÑ≤üÑ∫üÑ¥üÖÅ',
      'kerang': 'üÑ∫üÑ¥üÖÅüÑ∞üÑΩüÑ∂ üÑ∞üÑπüÑ∞üÑ∏üÑ±',
      'quotes': 'üÖÄüÖÑüÑæüÖÉüÑ¥üÖÇ',
      'admin': 'üÑ∞üÑ≥üÑºüÑ∏üÑΩ',
      '·¥ò·¥á…¥·¥Ö…™…¥…¢ s·¥õ·¥ú“ì“ì': '·¥ò·¥á…¥·¥Ö…™…¥…¢ s·¥õ·¥ú“ì“ì',
      'premium':'üÑ∂üÖÅüÑæüÖÑüÑø',
      'premium': 'üÑøüÖÅüÑ¥üÑºüÑ∏üÖÑüÑº',
      'internet': 'üÑ∏üÑΩüÖÉüÑ¥üÖÅüÑΩüÑ¥üÖÉ',
      'nulis': 'üÑΩüÖÑüÑªüÑ∏üÖÇ & üÑªüÑæüÑ∂üÑæ',
      'downloader': 'üÑ≥üÑæüÖÜüÑΩüÑªüÑæüÑ∞üÑ≥üÑ¥üÖÅ',
      'tools': 'üÖÉüÑæüÑæüÑªüÖÇ',
      'database': 'üÑ∞üÑ≥üÑ≥ üÑºüÑ¥üÖÇüÖÇüÑ∞üÑ∂üÑ¥',
      'info': 'üÑ∏üÑΩüÑµüÑæ',
      '': 'üÑæüÖÜüÑΩüÑ¥üÖÅ'
    }
    for (let plugin of Object.values(global.plugins))
      if (plugin && 'tags' in plugin)
        for (let tag of plugin.tags)
          if (!tag in  tags) tags[tag] = tag
    let help = Object.values(global.plugins).map(plugin => {
      return {
        help: plugin.help,
        tags: plugin.tags,
        prefix: 'customPrefx' in plugin,
        limit: plugin.limit
      }
    })
      var moes = moe[Math.floor(Math.random() * (moe.length))]
    let groups = {}
    for (let tag in tags) {
      groups[tag] = []
      for (let menu of help)
        if (menu.tags && menu.tags.includes(tag))
          if (menu.help) groups[tag].push(menu)
    }
    itsu.menu = itsu.menu ? itsu.menu : {}
    let before = itsu.menu.before || `
  ú…™, ${tag} 

  ü…™·¥ç…™·¥õ *%limit Limit*
 
 ·¥Ö·¥Ä·¥õ·¥á: *%week %weton, %date*üìÖ
 User: %totalreg
 
- Creator : ${ow}
- Partner : ${pat1}\n${pat2}\n${pat3}
%readmore`
    let header = itsu.menu.header || ` ${moe} ‚îâ‚îÑ‚îà‚îà‚îà „Äé  %category  „Äè ‚îâ‚îÑ‚îà‚îà‚îà ` 
    let body   = itsu.menu.body   || '‚û† %cmd%islimit'
    let footer = itsu.menu.footer || `‚Ä∫`.repeat(50) + '\n'
    let after  = itsu.menu.after  ||   (itsu.user.jid == global.itsu.user.jid ? '' : `Powered by https://wa.me/${global.itsu.user.jid.split`@`[0]}`) + `\n*%npmname@^%version*\n\`\`\`\%npmdesc\`\`\`` 
    ' Recode by itsu '
    let _text  = before + '\n'
    for (let tag in groups) {
      _text += header.replace(/%category/g, tags[tag]) + '\n'
      for (let menu of groups[tag]) {
        for (let help of menu.help)
          _text += body.replace(/%cmd/g, menu.prefix ? help : '%p' + help).replace(/%islimit/g, menu.limit ? ' (Limit)' : '')  + '\n'
      }
      _text += footer + '\n'
    }
    _text += after
    text =  typeof itsu.menu == 'string' ? itsu.menu : typeof itsu.menu == 'object' ? _text : ''
    let replace = {
      '%': '%',
      p: _p, uptime, muptime,
      npmname: package.name,
      npmdesc: package.description,
      version: package.version,
      exp: exp - min,
      maxexp: xp,
      totalexp: exp,
      xp4levelup: max - exp,
      github: package.homepage ? package.homepage.url || package.homepage : '[unknown github url]',
      level, limit, name, weton, week, date, dateIslamic, time, totalreg, rtotalreg,
      readmore: readMore
    }
    text = text.replace(new RegExp(`%(${Object.keys(replace).sort((a, b) => b.length - a.length).join`|`})`, 'g'), (_, name) => ''+replace[name])
let img = global.thumb2
const thumb = fs.readFileSync('./sis.jpeg')
let msg = await itsu.prepareMessage("0@s.whatsapp.net", img, "imageMessage", {thumbnail: thumb})
const buttons = [
{buttonId: `/sc`, buttonText: {displayText: 'sc'}, type: 1},

{buttonId: `/owner`, buttonText: {displayText: 'owner'}, type: 1}
]
const buttonsMessage = {
    contentText: `Ôº®ÔΩâ ÔΩïÔΩìÔΩÖÔΩí\n·µ¢‚Çò  ${itsu.user.name} \n\n\n- Bot group: ·¥õ ú·¥Ä ü·¥ã·¥Ä·¥Ä ü·¥Ä·¥ç …¢ Ä·¥è·¥ú·¥ò …™ ü ü·¥Ä\n\n- Github : https://github.com/lyfev4\n\n`,
    footerText: text,
    buttons: buttons,
    headerType: 4,
imageMessage: msg.message.imageMessage, thumbnail: global.thumb}
const sendMsg = await itsu.prepareMessageFromContent(m.chat,{buttonsMessage}, {quoted: anu,  thumbnail: pp, contextInfo: { mentionedJid: itsu.parseMention(text), externalAdReply: { title: `${ucapWaktu}`, body: `Time: ${clock}\nRuntime: ${Rtime}`, mediaUrl: tod, mediaType: 2, thumbnail: await (await fetch(pp)).buffer()}}})
itsu.relayWAMessage(sendMsg)
}


handler.help = ['alive']
handler.tags = ['main']
handler.command = /^404$/i
handler.owner = false
handler.mods = false
handler.premium = false
handler.group = false
handler.private = false

handler.admin = false
handler.botAdmin = false

handler.fail = null

module.exports = handler
